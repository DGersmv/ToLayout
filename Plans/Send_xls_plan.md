## План ветки `Send_xls`

### 1. Подготовка UI
- [x] Найти и открыть `RFIX/Selection_Test.html`, `RFIX/Selection_Test_ru.html` (и локализованные копии) — в них лежит палитра Selection Helper.
- [x] Добавить в блок кнопок новую кнопку `Отправить в Excel` с хендлером `openSendXlsPalette()` с учётом локализаций.
- [x] Подготовить новый HTML ресурc палитры, например `RFIX/Send_Xls.html`, зарегистрировать его в ресурсах и включить в `.grc`.

### 2. Новая палитра «Отправка в Excel»
- [x] Создать шаблон окна: шапка, таблица выбранных элементов (копируем логику Selection Helper), набор чекбоксов/галочек для свойств, таблица «Выбрано» по приоритету, кнопка «Сохранить».
- [x] Определить какие свойства выводим (ID, тип, слой, GUID, площадь, пользовательские свойства и т.д.) и сделать возможность отмечать чекбоксами.
- [x] Добавить под таблицей вторую таблицу, отражающую порядок выбранных свойств (перетаскивание или автонумерация).
- [x] Кнопки: `Сохранить` (открывает диалог имени файла) и `Отмена/закрыть`.

### 3. Связь с C++/ACAPI
- [x] Создать C++ класс палитры `SendXlsPalette` (по аналогии с `ContourPalette`, `MeshPalette`).
- [x] Прописать GUID, ресурс, регистрацию в `BrowserRepl.cpp` и `ResourceIDs.hpp`.
- [x] В JS новой палитры подписаться на `window.ACAPI` функции: получать текущее выделение через `ACAPI.GetSelectedElements`, обновлять таблицу при изменении.

### 4. Экспорт данных
- [x] Реализовать на стороне JS сбор выбранных свойств в структуру (массив объектов).
- [x] Добавить вызов `ACAPI.SaveSendXls(data)` (новая функция), которая откроет нативный диалог `ACAPI_Interface(APIIo_Save)` и сохранит результат в CSV/Excel.
- [x] На C++ стороне добавить хелпер (например, в `SelectionHelper` или новый `SendXlsHelper`) для конвертации данных в CSV (либо вызов какого-либо XLSX генератора, если есть).
- [x] Учитывать кодировку UTF-8 и разделитель (точка с запятой или таб).

### 5. UI сохранения
- [x] «Сохранить» в JS → вызвать `ACAPI.OpenSaveDialog` (если есть мост), дождаться выбранного пути.
- [ ] После успешного экспорта показать уведомление пользователю и лог в основной палитре.

### 6. Локализация и тесты
- [ ] Обновить переводы (`RFIX/Selection_Test_es.html`, `Translations/...`) для новой кнопки.
- [ ] Добавить локализованные строки для свойств/подсказок в новой палитре.
- [ ] Протестировать: выбор элементов, переключение свойств, экспорт CSV/Excel, корректная кодировка.

### 7. Документация
- [ ] Обновить `BUILD_INSTRUCTIONS.md` или добавить раздел «Экспорт в Excel».
- [ ] Добавить краткую справку в `RFIX/.../help`.





